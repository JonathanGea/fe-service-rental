<nav
  aria-label="Admin"
  class="w-full border-b border-default/60 transition-all duration-200"
  [ngClass]="
    isScrolled
      ? 'bg-surface shadow-sm'
      : 'bg-surface/70 backdrop-blur-md shadow-none'
  "
>
  <div class="flex h-16 w-full items-center gap-4 px-4 sm:px-6 lg:px-8">
    <div class="flex items-center gap-3">
      <button
        type="button"
        aria-label="Open menu"
        class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
        (click)="onToggleMenu()"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 5.25h16.5M3.75 12h16.5M3.75 18.75h16.5" />
        </svg>
      </button>

      <div class="min-w-0">
        <div class="truncate text-xs text-strong/60">
          <span *ngFor="let crumb of breadcrumbs; let last = last">
            {{ crumb }}<span *ngIf="!last"> / </span>
          </span>
        </div>
        <div class="truncate text-base font-semibold text-strong sm:text-lg">{{ pageTitle }}</div>
      </div>
    </div>

    <div class="flex-1"></div>

    <div class="flex items-center gap-3">
      <a
        routerLink="/admin/vehicles"
        class="hidden items-center gap-2 rounded-xl border border-default bg-app px-3 py-2 text-xs font-semibold text-strong/80 transition hover:text-primary md:flex"
      >
        <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 16V9l2-4h14l2 4v7" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M5 16a2 2 0 1 0 4 0H5Z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 16a2 2 0 1 0 4 0h-4Z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18" />
        </svg>
        Kendaraan
      </a>
      <div class="relative hidden w-64 sm:block md:w-72 lg:w-80">
        <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-strong/50">
          <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-4.35-4.35M17 10.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0Z" />
          </svg>
        </span>
        <input
          #desktopSearchInput
          type="search"
          aria-label="Search"
          placeholder="Search here"
          class="w-full rounded-xl border border-default bg-app py-2 pl-10 pr-4 text-sm text-strong placeholder:text-strong/50 focus:outline-none focus:ring-2 focus:ring-primary/30"
          (input)="onSearchInput(desktopSearchInput.value)"
          (keydown.enter)="onSearchEnter(desktopSearchInput.value)"
        />
      </div>

      <div class="relative" appClickOutside (appClickOutside)="closeUserMenu()">
        <button
          type="button"
          aria-label="User menu"
          aria-haspopup="menu"
          [attr.aria-expanded]="isUserMenuOpen"
          aria-controls="admin-user-menu"
          class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
          (click)="toggleUserMenu()"
        >
          <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.5 7.5 0 0 0 12 15.75a7.5 7.5 0 0 0-5.982 2.975M15.75 7.5a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
          </svg>
        </button>

        <div
          id="admin-user-menu"
          role="menu"
          class="absolute right-0 mt-2 w-52 origin-top-right rounded-xl border border-default bg-surface p-2 shadow-lg transition"
          [ngClass]="
            isUserMenuOpen
              ? 'pointer-events-auto scale-100 opacity-100'
              : 'pointer-events-none scale-95 opacity-0'
          "
        >
          <div class="rounded-lg border border-default bg-app px-3 py-2">
            <p class="text-[10px] uppercase tracking-[0.2em] text-strong/60">Signed In</p>
            <p class="text-sm font-semibold text-strong">{{ userEmail || 'Admin' }}</p>
            <p class="text-[11px] text-strong/60">{{ userRole || 'Administrator' }}</p>
          </div>
          <button
            type="button"
            role="menuitem"
            class="mt-2 flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-semibold text-strong/70 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
            (click)="onLogoutClick()"
          >
            <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6A2.25 2.25 0 0 0 5.25 5.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
            </svg>
            Logout
          </button>
        </div>
      </div>

      <button
        type="button"
        aria-label="Settings"
        class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h3m-3 12h3m-6-6h9m2.25 6.75a2.25 2.25 0 0 0 2.25-2.25V7.5A2.25 2.25 0 0 0 18.75 5.25H5.25A2.25 2.25 0 0 0 3 7.5v9.0a2.25 2.25 0 0 0 2.25 2.25h13.5Z" />
        </svg>
      </button>

      <button
        type="button"
        aria-label="Notifications"
        class="relative inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 1 5.454 1.31A8.967 8.967 0 0 0 18 9.75V9a6 6 0 1 0-12 0v.75a8.967 8.967 0 0 0-2.312 8.642 23.848 23.848 0 0 1 5.454-1.31m5.715 0a24.255 24.255 0 0 0-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
        </svg>
        <span class="sr-only">You have {{ notificationsCount }} notifications</span>
        <span class="absolute -right-1 -top-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full bg-primary px-1 text-[10px] font-semibold text-white">
          {{ notificationsCount }}
        </span>
      </button>
    </div>
  </div>
</nav>
