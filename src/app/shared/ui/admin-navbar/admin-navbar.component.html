<nav
  aria-label="Admin"
  class="w-full border-b border-default/60 transition-all duration-200"
  [ngClass]="
    isScrolled
      ? 'bg-surface shadow-sm'
      : 'bg-surface/70 backdrop-blur-md shadow-none'
  "
>
  <div class="flex h-16 w-full items-center gap-4 px-4 sm:px-6 lg:px-8">
    <div class="flex items-center gap-3">
      <button
        type="button"
        aria-label="Open menu"
        class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
        (click)="onToggleMenu()"
      >
        <i class="fa-solid fa-bars text-lg" aria-hidden="true"></i>
      </button>

      <div class="min-w-0">
        <div class="truncate text-xs text-strong/60">
          <span *ngFor="let crumb of breadcrumbs; let last = last">
            {{ crumb }}<span *ngIf="!last"> / </span>
          </span>
        </div>
        <div class="truncate text-base font-semibold text-strong sm:text-lg">{{ pageTitle }}</div>
      </div>
    </div>

    <div class="flex-1"></div>

    <div class="flex items-center gap-3">
      <a
        routerLink="/admin/vehicles"
        class="hidden items-center gap-2 rounded-xl border border-default bg-app px-3 py-2 text-xs font-semibold text-strong/80 transition hover:text-primary md:flex"
      >
        <i class="fa-solid fa-car-side text-base" aria-hidden="true"></i>
        Kendaraan
      </a>
      <div class="relative hidden w-64 sm:block md:w-72 lg:w-80">
        <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-strong/50">
          <i class="fa-solid fa-magnifying-glass text-base" aria-hidden="true"></i>
        </span>
        <input
          #desktopSearchInput
          type="search"
          aria-label="Search"
          placeholder="Search here"
          class="w-full rounded-xl border border-default bg-app py-2 pl-10 pr-4 text-sm text-strong placeholder:text-strong/50 focus:outline-none focus:ring-2 focus:ring-primary/30"
          (input)="onSearchInput(desktopSearchInput.value)"
          (keydown.enter)="onSearchEnter(desktopSearchInput.value)"
        />
      </div>

      <div class="relative" appClickOutside (appClickOutside)="closeUserMenu()">
        <button
          type="button"
          aria-label="User menu"
          aria-haspopup="menu"
          [attr.aria-expanded]="isUserMenuOpen"
          aria-controls="admin-user-menu"
          class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
          (click)="toggleUserMenu()"
        >
          <i class="fa-solid fa-user text-lg" aria-hidden="true"></i>
        </button>

        <div
          id="admin-user-menu"
          role="menu"
          class="absolute right-0 mt-2 w-52 origin-top-right rounded-xl border border-default bg-surface p-2 shadow-lg transition"
          [ngClass]="
            isUserMenuOpen
              ? 'pointer-events-auto scale-100 opacity-100'
              : 'pointer-events-none scale-95 opacity-0'
          "
        >
          <div class="rounded-lg border border-default bg-app px-3 py-2">
            <p class="text-[10px] uppercase tracking-[0.2em] text-strong/60">Signed In</p>
            <p class="text-sm font-semibold text-strong">{{ userEmail || 'Admin' }}</p>
            <p class="text-[11px] text-strong/60">{{ userRole || 'Administrator' }}</p>
          </div>
          <button
            type="button"
            role="menuitem"
            class="mt-2 flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-semibold text-strong/70 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
            (click)="onLogoutClick()"
          >
            <i class="fa-solid fa-right-from-bracket text-base" aria-hidden="true"></i>
            Logout
          </button>
        </div>
      </div>

      <button
        type="button"
        aria-label="Settings"
        class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
      >
        <i class="fa-solid fa-sliders text-lg" aria-hidden="true"></i>
      </button>

      <button
        type="button"
        aria-label="Notifications"
        class="relative inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
      >
        <i class="fa-solid fa-bell text-lg" aria-hidden="true"></i>
        <span class="sr-only">You have {{ notificationsCount }} notifications</span>
        <span class="absolute -right-1 -top-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full bg-primary px-1 text-[10px] font-semibold text-white">
          {{ notificationsCount }}
        </span>
      </button>
    </div>
  </div>
</nav>
