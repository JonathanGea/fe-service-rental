<nav
  aria-label="Admin"
  class="w-full border-b border-default/60 transition-all duration-200"
  [ngClass]="
    isScrolled
      ? 'bg-surface shadow-sm'
      : 'bg-surface/70 backdrop-blur-md shadow-none'
  "
>
  <div class="flex h-16 w-full items-center gap-4 px-4 sm:px-6 lg:px-8">
    <div class="flex items-center gap-3">
      <button
        type="button"
        aria-label="Open menu"
        class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
        (click)="onToggleMenu()"
      >
        <svg
          viewBox="0 0 24 24"
          class="h-5 w-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
        >
          <path d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>

      <div class="min-w-0">
        <div class="truncate text-xs text-strong/60">
          <span *ngFor="let crumb of breadcrumbs; let last = last">
            {{ crumb }}<span *ngIf="!last"> / </span>
          </span>
        </div>
        <div class="truncate text-base font-semibold text-strong sm:text-lg">{{ pageTitle }}</div>
      </div>
    </div>

    <div class="flex-1"></div>

    <div class="flex items-center gap-3">
      <div class="relative hidden w-64 sm:block md:w-72 lg:w-80">
        <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-strong/50">
          <svg
            viewBox="0 0 24 24"
            class="h-4 w-4"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
          >
            <circle cx="11" cy="11" r="7" />
            <path d="M20 20l-3.5-3.5" />
          </svg>
        </span>
        <input
          #desktopSearchInput
          type="search"
          aria-label="Search"
          placeholder="Search here"
          class="w-full rounded-xl border border-default bg-app py-2 pl-10 pr-4 text-sm text-strong placeholder:text-strong/50 focus:outline-none focus:ring-2 focus:ring-primary/30"
          (input)="onSearchInput(desktopSearchInput.value)"
          (keydown.enter)="onSearchEnter(desktopSearchInput.value)"
        />
      </div>

      <div class="relative" appClickOutside (appClickOutside)="closeUserMenu()">
        <button
          type="button"
          aria-label="User menu"
          aria-haspopup="menu"
          [attr.aria-expanded]="isUserMenuOpen"
          aria-controls="admin-user-menu"
          class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
          (click)="toggleUserMenu()"
        >
          <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="8" r="4" />
            <path d="M4 20a8 8 0 0116 0" />
          </svg>
        </button>

        <div
          id="admin-user-menu"
          role="menu"
          class="absolute right-0 mt-2 w-52 origin-top-right rounded-xl border border-default bg-surface p-2 shadow-lg transition"
          [ngClass]="
            isUserMenuOpen
              ? 'pointer-events-auto scale-100 opacity-100'
              : 'pointer-events-none scale-95 opacity-0'
          "
        >
          <div class="rounded-lg border border-default bg-app px-3 py-2">
            <p class="text-[10px] uppercase tracking-[0.2em] text-strong/60">Signed In</p>
            <p class="text-sm font-semibold text-strong">{{ userEmail || 'Admin' }}</p>
            <p class="text-[11px] text-strong/60">{{ userRole || 'Administrator' }}</p>
          </div>
          <button
            type="button"
            role="menuitem"
            class="mt-2 flex w-full items-center gap-2 rounded-lg px-3 py-2 text-xs font-semibold text-strong/70 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
            (click)="onLogoutClick()"
          >
            <svg
              viewBox="0 0 24 24"
              class="h-4 w-4"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4" />
              <path d="M10 17l5-5-5-5" />
              <path d="M15 12H3" />
            </svg>
            Logout
          </button>
        </div>
      </div>

      <button
        type="button"
        aria-label="Settings"
        class="inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
      >
        <svg
          viewBox="0 0 24 24"
          class="h-5 w-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="12" cy="12" r="3" />
          <path d="M19.4 15a1.6 1.6 0 0 0 .3 1.7l.1.1a2 2 0 0 1-2.8 2.8l-.1-.1a1.6 1.6 0 0 0-1.7-.3 1.6 1.6 0 0 0-1 1.4V21a2 2 0 0 1-4 0v-.2a1.6 1.6 0 0 0-1-1.4 1.6 1.6 0 0 0-1.7.3l-.1.1a2 2 0 0 1-2.8-2.8l.1-.1a1.6 1.6 0 0 0 .3-1.7 1.6 1.6 0 0 0-1.4-1H3a2 2 0 0 1 0-4h.2a1.6 1.6 0 0 0 1.4-1 1.6 1.6 0 0 0-.3-1.7l-.1-.1a2 2 0 1 1 2.8-2.8l.1.1a1.6 1.6 0 0 0 1.7.3 1.6 1.6 0 0 0 1-1.4V3a2 2 0 0 1 4 0v.2a1.6 1.6 0 0 0 1 1.4 1.6 1.6 0 0 0 1.7-.3l.1-.1a2 2 0 1 1 2.8 2.8l-.1.1a1.6 1.6 0 0 0-.3 1.7 1.6 1.6 0 0 0 1.4 1H21a2 2 0 0 1 0 4h-.2a1.6 1.6 0 0 0-1.4 1z"
          />
        </svg>
      </button>

      <button
        type="button"
        aria-label="Notifications"
        class="relative inline-flex h-10 w-10 items-center justify-center rounded-xl border border-default text-strong transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/30"
      >
        <svg
          viewBox="0 0 24 24"
          class="h-5 w-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M18 8a6 6 0 10-12 0c0 7-3 7-3 7h18s-3 0-3-7" />
          <path d="M13.73 21a2 2 0 01-3.46 0" />
        </svg>
        <span class="sr-only">You have {{ notificationsCount }} notifications</span>
        <span class="absolute -right-1 -top-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full bg-primary px-1 text-[10px] font-semibold text-white">
          {{ notificationsCount }}
        </span>
      </button>
    </div>
  </div>
</nav>
